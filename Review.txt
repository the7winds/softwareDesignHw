Код оказался достаточно удобным и хорошо организованным.
В частности, не пришлось читать весь код и понимать особо внутренне устройство программы, чтобы добавить команды.
Однако, некоторые решения были сходу не совсем очевидными.
Например то, как разбираются аргументы или почему список команд лежит в Environment.
